- name: Collect all unique keys
  set_fact:
    all_keys: "{{ (last_sync_response.keys() | list + last_heartbeat.keys() | list + last_password_set.keys() | list) | unique }}"

- name: Combine data with default empty values for missing entries
  set_fact:
    combined_data: "{{ combined_data | default({}) | combine({ item: { 
      'last_sync_response': last_sync_response.get(item, ''), 
      'last_heartbeat': last_heartbeat.get(item, ''), 
      'last_password_set': last_password_set.get(item, '') 
    } }) }}"
  loop: "{{ all_keys }}"
  loop_control:
    label: "{{ item }}"
  no_log: true

- name: Display the final combined dictionary
  debug:
    var: combined_data
