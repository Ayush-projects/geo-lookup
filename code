- name: Collect all unique device IDs
  set_fact:
    all_device_ids: "{{ (last_sync_response.keys() | list + last_heartbeat.keys() | list + last_password_set.keys() | list) | unique }}"

- name: Initialize combined_data
  set_fact:
    combined_data: {}

- name: Build combined_data
  set_fact:
    combined_data: "{{ combined_data | combine({ item: {'last_sync_response': last_sync_response.get(item, ''), 'last_heartbeat': last_heartbeat.get(item, ''), 'last_password_set': last_password_set.get(item, '')} }, recursive=True) }}"
  loop: "{{ all_device_ids }}"
